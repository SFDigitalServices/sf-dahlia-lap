#!/bin/bash
# for reference:
# http://dev.ghost.org/prevent-master-push/
# https://gist.github.com/pixelhandler/5718585

BRANCH=`git rev-parse --abbrev-ref HEAD`
PROTECTED_BRANCHES="^(main|demo|staging|production)"

if [[ "$BRANCH" =~ $PROTECTED_BRANCHES ]]
then
    # read -p "You're about to push to a protected branch (e.g. main), is that what you intended? [y|n] " -n 1 -r < /dev/tty
    echo "You are not allowed to commit directly to a protected branch (e.g. main). Please use a branch for your feature and submit a pull request to main."
    exit 1 # push will NOT execute
else
  exit 0 # push will execute
fi
